/* eslint-disable */

import Head from 'next/head';
import style from '../styles/Home.module.css';
import Link from 'next/link';
import { NextRouter, useRouter } from 'next/router';
import { signIn, signOut, useSession } from 'next-auth/react';

export default function Home() {
    const router: NextRouter = useRouter();

    return (
        <>
            <Head>
                <title>Create Next App</title>
                <meta
                    name="description"
                    content="Generated by create next app"
                />
                <meta
                    name="viewport"
                    content="width=device-width, initial-scale=1"
                />
                <link rel="icon" href="/favicon.ico" />
            </Head>
            <SessionComponent />
            <main className={style.main}>
                <h1>Welcome to the hhhhhhhref challenge</h1>

                <Link href="/register" className={style.nextlink}>
                    Register
                </Link>

                <Link href="/rdr" className={style.nextlink}>
                    Redirect (this page is for admin only :bow:)
                </Link>

                <Link href="/crawl" className={style.nextlink}>
                    Crawler
                </Link>
            </main>
        </>
    );
}

export function SessionComponent() {
    const { data: session } = useSession();
    if (session && session.user) {
        return (
            <>
                <div className={style.userinfo}>
                    Signed in as <b>{session.user.name}</b> <br />
                    <button
                        onClick={async () => {
                            await fetch('/api/auth/clear', { method: 'POST' });
                            signOut();
                        }}
                    >
                        Sign out
                    </button>
                </div>
            </>
        );
    }

    return (
        <>
            <div className={style.userinfo}>
                Not signed in <br />
                <button onClick={() => signIn()}>Sign in</button>
            </div>
        </>
    );
}
